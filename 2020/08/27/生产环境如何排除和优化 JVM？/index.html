<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>生产环境如何排除和优化 JVM？ | 凌虚阁</title><meta name="description" content="第26讲：生产环境如何排除和优化 JVM？通过前面几个课时的学习，相信你对 JVM 的理论及实践等相关知识有了一个大体的印象。而本课时将重点讲解 JVM 的排查与优化，这样就会对 JVM 的知识点有一个完整的认识，从而可以更好地应用于实际工作或者面试了。 我们本课时的面试题是，生产环境如何排查问题？ 典型回答如果是在生产环境中直接排查 JVM 的话，最简单的做法就是使用 JDK 自带的 6 个非常"><meta name="keywords" content="Java"><meta name="author" content="GuoTao"><meta name="copyright" content="GuoTao"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tomones.github.io/2020/08/27/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E6%8E%92%E9%99%A4%E5%92%8C%E4%BC%98%E5%8C%96%20JVM%EF%BC%9F/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="生产环境如何排除和优化 JVM？"><meta property="og:url" content="https://tomones.github.io/2020/08/27/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E6%8E%92%E9%99%A4%E5%92%8C%E4%BC%98%E5%8C%96%20JVM%EF%BC%9F/"><meta property="og:site_name" content="凌虚阁"><meta property="og:description" content="第26讲：生产环境如何排除和优化 JVM？通过前面几个课时的学习，相信你对 JVM 的理论及实践等相关知识有了一个大体的印象。而本课时将重点讲解 JVM 的排查与优化，这样就会对 JVM 的知识点有一个完整的认识，从而可以更好地应用于实际工作或者面试了。 我们本课时的面试题是，生产环境如何排查问题？ 典型回答如果是在生产环境中直接排查 JVM 的话，最简单的做法就是使用 JDK 自带的 6 个非常"><meta property="og:image" content="http://cdn.andiycc.com/fengmian.jpg"><meta property="article:published_time" content="2020-08-27T15:16:23.000Z"><meta property="article:modified_time" content="2020-09-09T14:29:42.833Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="深克隆和浅克隆有什么区别？它的实现方式有哪些？" href="https://tomones.github.io/2020/08/27/%E6%B7%B1%E5%85%8B%E9%9A%86%E5%92%8C%E6%B5%85%E5%85%8B%E9%9A%86%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F%E5%AE%83%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B?%20/"><link rel="next" title="红黑树和平衡二叉树有什么区别？" href="https://tomones.github.io/2020/08/27/%E7%BA%A2%E9%BB%91%E6%A0%91%E5%92%8C%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="凌虚阁" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="http://cdn.andiycc.com/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><span> 娱乐</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第26讲：生产环境如何排除和优化-JVM？"><span class="toc-number">1.</span> <span class="toc-text">第26讲：生产环境如何排除和优化 JVM？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#典型回答"><span class="toc-number">1.1.</span> <span class="toc-text">典型回答</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-jps（虚拟机进程状况工具）"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. jps（虚拟机进程状况工具）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-jstat（虚拟机统计信息监视工具）"><span class="toc-number">1.1.2.</span> <span class="toc-text">2. jstat（虚拟机统计信息监视工具）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-jinfo（查询虚拟机参数配置工具）"><span class="toc-number">1.1.3.</span> <span class="toc-text">3. jinfo（查询虚拟机参数配置工具）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-jmap（堆快照生成工具）"><span class="toc-number">1.1.4.</span> <span class="toc-text">4. jmap（堆快照生成工具）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-jhat（堆快照分析功能）"><span class="toc-number">1.1.5.</span> <span class="toc-text">5. jhat（堆快照分析功能）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-jstack（查询虚拟机当前的线程快照信息）"><span class="toc-number">1.1.6.</span> <span class="toc-text">6. jstack（查询虚拟机当前的线程快照信息）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#考点分析"><span class="toc-number">1.2.</span> <span class="toc-text">考点分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#知识扩展"><span class="toc-number">1.3.</span> <span class="toc-text">知识扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#可视化排查工具"><span class="toc-number">1.3.1.</span> <span class="toc-text">可视化排查工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JVM-调优"><span class="toc-number">1.3.2.</span> <span class="toc-text">JVM 调优</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结"><span class="toc-number">1.4.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(http://cdn.andiycc.com/fengmian.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">凌虚阁</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><span> 娱乐</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">生产环境如何排除和优化 JVM？</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-08-27 23:16:23"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-08-27</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-09-09 22:29:42"><i class="fas fa-history fa-fw"></i> 更新于 2020-09-09</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Java%E8%BF%9B%E9%98%B6/">Java进阶</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">3.9k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 17 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="第26讲：生产环境如何排除和优化-JVM？"><a href="#第26讲：生产环境如何排除和优化-JVM？" class="headerlink" title="第26讲：生产环境如何排除和优化 JVM？"></a>第26讲：生产环境如何排除和优化 JVM？</h2><p>通过前面几个课时的学习，相信你对 JVM 的理论及实践等相关知识有了一个大体的印象。而本课时将重点讲解 JVM 的排查与优化，这样就会对 JVM 的知识点有一个完整的认识，从而可以更好地应用于实际工作或者面试了。</p>
<p>我们本课时的面试题是，生产环境如何排查问题？</p>
<h3 id="典型回答"><a href="#典型回答" class="headerlink" title="典型回答"></a>典型回答</h3><p>如果是在生产环境中直接排查 JVM 的话，最简单的做法就是使用 JDK 自带的 6 个非常实用的命令行工具来排查。它们分别是：jps、jstat、jinfo、jmap、jhat 和 jstack，它们都位于 JDK 的 bin 目录下，可以使用命令行工具直接运行，其目录如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/CgqCHl7Z6XeAXH4mAAQG2yKoYrQ797-20200830161706093.png" alt="Drawing 0.png"></p>
<p>接下来我们来看看这些工具的具体使用。</p>
<h4 id="1-jps（虚拟机进程状况工具）"><a href="#1-jps（虚拟机进程状况工具）" class="headerlink" title="1. jps（虚拟机进程状况工具）"></a>1. jps（虚拟机进程状况工具）</h4><p>jps（JVM Process Status tool，虚拟机进程状况工具）它的功能和 Linux 中的 ps 命令比较类似，用于列出正在运行的 JVM 的 LVMID（Local Virtual Machine IDentifier，本地虚拟机唯一 ID），以及 JVM 的执行主类、JVM 启动参数等信息。语法如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps [options] [hostid]</span><br></pre></td></tr></table></figure>

<p>常用的 options 选项：</p>
<ul>
<li>-l：用于输出运行主类的全名，如果是 jar 包，则输出 jar 包的路径；</li>
<li>-q：用于输出 LVMID（Local Virtual Machine Identifier，虚拟机唯一 ID）；</li>
<li>-m：用于输出虚拟机启动时传递给主类 main() 方法的参数；</li>
<li>-v：用于输出启动时的 JVM 参数。</li>
</ul>
<p>使用实例：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">➜  jps <span class="literal">-l</span></span><br><span class="line"><span class="number">68848</span></span><br><span class="line"><span class="number">40085</span> org.jetbrains.jps.cmdline.Launcher</span><br><span class="line"><span class="number">40086</span> com.example.optimize.NativeOptimize</span><br><span class="line"><span class="number">40109</span> jdk.jcmd/sun.tools.jps.Jps</span><br><span class="line"><span class="number">68879</span> org.jetbrains.idea.maven.server.RemoteMavenServer36</span><br><span class="line">➜  jps <span class="literal">-q</span></span><br><span class="line"><span class="number">40368</span></span><br><span class="line"><span class="number">68848</span></span><br><span class="line"><span class="number">40085</span></span><br><span class="line"><span class="number">40086</span></span><br><span class="line"><span class="number">68879</span></span><br><span class="line">➜  jps <span class="literal">-m</span></span><br><span class="line"><span class="number">40400</span> Jps <span class="literal">-m</span></span><br><span class="line"><span class="number">68848</span></span><br><span class="line"><span class="number">40085</span> Launcher /Applications/IntelliJ IDEA2.app/Contents/lib/idea_rt.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/oro<span class="literal">-2</span>.<span class="number">0.8</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/resources_en.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/maven<span class="literal">-model</span><span class="literal">-3</span>.<span class="number">6.1</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/qdox<span class="literal">-2</span>.<span class="number">0</span><span class="literal">-M10</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/plexus<span class="literal">-component</span><span class="literal">-annotations</span><span class="literal">-1</span>.<span class="number">7.1</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/httpcore<span class="literal">-4</span>.<span class="number">4.13</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/maven<span class="literal">-resolver</span><span class="literal">-api</span><span class="literal">-1</span>.<span class="number">3.3</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/netty<span class="literal">-common</span><span class="literal">-4</span>.<span class="number">1.47</span>.Final.jar:/Applications/IntelliJ IDEA2.app/Contents/plugins/java/lib/maven<span class="literal">-resolver</span><span class="literal">-connector</span><span class="literal">-basic</span><span class="literal">-1</span>.<span class="number">3.3</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/maven<span class="literal">-artifact</span><span class="literal">-3</span>.<span class="number">6.1</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/plexus<span class="literal">-utils</span><span class="literal">-3</span>.<span class="number">2.0</span>.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/netty<span class="literal">-resolver</span><span class="literal">-4</span>.<span class="number">1.47</span>.Final.jar:/Applications/IntelliJ IDEA2.app/Contents/lib/guava<span class="literal">-28</span>.<span class="number">2</span>-</span><br><span class="line"><span class="number">40086</span> NativeOptimize</span><br><span class="line"><span class="number">68879</span> RemoteMavenServer36</span><br><span class="line">➜  jps <span class="literal">-v</span></span><br><span class="line"><span class="number">68848</span>  <span class="literal">-Xms128m</span> <span class="literal">-Xmx2048m</span> <span class="literal">-XX</span>:ReservedCodeCacheSize=<span class="number">240</span>m <span class="literal">-XX</span>:+UseCompressedOops <span class="literal">-Dfile</span>.encoding=UTF<span class="literal">-8</span> <span class="literal">-XX</span>:+UseConcMarkSweepGC <span class="literal">-XX</span>:SoftRefLRUPolicyMSPerMB=<span class="number">50</span> <span class="literal">-ea</span> <span class="literal">-XX</span>:CICompilerCount=<span class="number">2</span> <span class="literal">-Dsun</span>.io.useCanonPrefixCache=false <span class="literal">-Djava</span>.net.preferIPv4Stack=true <span class="literal">-Djdk</span>.http.auth.tunneling.disabledSchemes=<span class="string">""</span> <span class="literal">-XX</span>:+HeapDumpOnOutOfMemoryError <span class="literal">-XX</span>:<span class="literal">-OmitStackTraceInFastThrow</span> <span class="literal">-Djdk</span>.attach.allowAttachSelf <span class="literal">-Dkotlinx</span>.coroutines.debug=off <span class="literal">-Djdk</span>.module.illegalAccess.silent=true <span class="literal">-Xverify</span>:none <span class="literal">-XX</span>:ErrorFile=/Users/admin/java_error_in_idea_%p.log <span class="literal">-XX</span>:HeapDumpPath=/Users/admin/java_error_in_idea.hprof <span class="literal">-javaagent</span>:/Users/admin/.jetbrains/jetbrains<span class="literal">-agent</span><span class="literal">-v3</span>.<span class="number">2.0</span>.de72.<span class="number">619</span> <span class="literal">-Djb</span>.vmOptionsFile=/Users/admin/Library/Application Support/JetBrains/IntelliJIdea2020.<span class="number">1</span>/idea.vmoptions <span class="literal">-Didea</span>.paths.selector=IntelliJIdea2020.<span class="number">1</span> <span class="literal">-Didea</span>.executable=idea <span class="literal">-Didea</span>.home.path=/Applications/IntelliJ IDEA2.app/Contents <span class="literal">-Didea</span>.vendor.name=JetBrains</span><br><span class="line"><span class="number">40085</span> Launcher <span class="literal">-Xmx700m</span> <span class="literal">-Djava</span>.awt.headless=true <span class="literal">-Djava</span>.endorsed.dirs=<span class="string">""</span> <span class="literal">-Djdt</span>.compiler.useSingleThread=true <span class="literal">-Dpreload</span>.project.path=/Users/admin/github/blog<span class="literal">-example</span>/blog<span class="literal">-example</span> <span class="literal">-Dpreload</span>.config.path=/Users/admin/Library/Application Support/JetBrains/IntelliJIdea2020.<span class="number">1</span>/options <span class="literal">-Dcompile</span>.parallel=false <span class="literal">-Drebuild</span>.on.dependency.change=true <span class="literal">-Djava</span>.net.preferIPv4Stack=true <span class="literal">-Dio</span>.netty.initialSeedUniquifier=<span class="number">1366842080359982660</span> <span class="literal">-Dfile</span>.encoding=UTF<span class="literal">-8</span> <span class="literal">-Duser</span>.language=zh <span class="literal">-Duser</span>.country=CN <span class="literal">-Didea</span>.paths.selector=IntelliJIdea2020.<span class="number">1</span> <span class="literal">-Didea</span>.home.path=/Applications/IntelliJ IDEA2.app/Contents <span class="literal">-Didea</span>.config.path=/Users/admin/Library/Application Support/JetBrains/IntelliJIdea2020.<span class="number">1</span> <span class="literal">-Didea</span>.plugins.path=/Users/admin/Library/Application Support/JetBrains/IntelliJIdea2020.<span class="number">1</span>/plugins <span class="literal">-Djps</span>.log.dir=/Users/admin/Library/Logs/JetBrains/IntelliJIdea2020.<span class="number">1</span>/build<span class="literal">-log</span> <span class="literal">-Djps</span>.fallback.jdk.home=/Applications/IntelliJ IDEA2.app/Contents/jbr/Contents/Home <span class="literal">-Djps</span>.fallback.jdk.version=<span class="number">11.0</span>.<span class="number">6</span> <span class="literal">-Dio</span>.netty.noUnsafe=true <span class="literal">-Djava</span>.io.tmpdir=/Users/admin/Library/Caches/Je</span><br><span class="line"><span class="number">40086</span> NativeOptimize <span class="literal">-Dfile</span>.encoding=UTF<span class="literal">-8</span></span><br><span class="line"><span class="number">40425</span> Jps <span class="literal">-Dapplication</span>.home=/Users/admin/Library/Java/JavaVirtualMachines/openjdk<span class="literal">-14</span>/Contents/Home <span class="literal">-Xms8m</span> <span class="literal">-Djdk</span>.module.main=jdk.jcmd</span><br><span class="line"><span class="number">68879</span> RemoteMavenServer36 <span class="literal">-Djava</span>.awt.headless=true <span class="literal">-Dmaven</span>.defaultProjectBuilder.disableGlobalModelCache=true <span class="literal">-Xmx768m</span> <span class="literal">-Didea</span>.maven.embedder.version=<span class="number">3.6</span>.<span class="number">1</span> <span class="literal">-Dmaven</span>.ext<span class="class">.<span class="keyword">class</span>.<span class="title">path</span>=/<span class="title">Applications</span>/<span class="title">IntelliJ</span> <span class="title">IDEA2</span>.<span class="title">app</span>/<span class="title">Contents</span>/<span class="title">plugins</span>/<span class="title">maven</span>/<span class="title">lib</span>/<span class="title">maven</span>-<span class="title">event</span>-<span class="title">listener</span>.<span class="title">jar</span> -<span class="title">Dfile</span>.<span class="title">encoding</span>=<span class="title">UTF</span>-8</span></span><br></pre></td></tr></table></figure>

<h4 id="2-jstat（虚拟机统计信息监视工具）"><a href="#2-jstat（虚拟机统计信息监视工具）" class="headerlink" title="2. jstat（虚拟机统计信息监视工具）"></a>2. jstat（虚拟机统计信息监视工具）</h4><p>jstat（JVM Statistics Monitoring Tool，虚拟机统计信息监视工具）用于监控虚拟机的运行状态信息。</p>
<p>例如，我们用它来查询某个 Java 进程的垃圾收集情况，示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  jstat -gc <span class="number">43704</span></span><br><span class="line"> S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT    CGC    CGCT     GCT</span><br><span class="line"><span class="number">10752.0</span> <span class="number">10752.0</span>  <span class="number">0.0</span>    <span class="number">0.0</span>   <span class="number">65536.0</span>   <span class="number">5243.4</span>   <span class="number">175104.0</span>     <span class="number">0.0</span>     <span class="number">4480.0</span> <span class="number">774.0</span>  <span class="number">384.0</span>   <span class="number">75.8</span>       <span class="number">0</span>    <span class="number">0.000</span>   <span class="number">0</span>      <span class="number">0.000</span>   -          -    <span class="number">0.000</span></span><br></pre></td></tr></table></figure>

<p>参数说明如下表所示：</p>
<table>
<thead>
<tr>
<th><strong>参数</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>S0C</td>
<td>年轻代中第一个存活区的大小</td>
</tr>
<tr>
<td>S1C</td>
<td>年轻代中第二个存活区的大小</td>
</tr>
<tr>
<td>S0U</td>
<td>年轻代中第一个存活区已使用的空间（字节）</td>
</tr>
<tr>
<td>S1U</td>
<td>年轻代中第二个存活区已使用的空间（字节）</td>
</tr>
<tr>
<td>EC</td>
<td>Edem 区大小</td>
</tr>
<tr>
<td>EU</td>
<td>年轻代中 Edem 区已使用的空间（字节）</td>
</tr>
<tr>
<td>OC</td>
<td>老年代大小</td>
</tr>
<tr>
<td>OU</td>
<td>老年代已使用的空间（字节）</td>
</tr>
<tr>
<td>YGC</td>
<td>从应用程序启动到采样时 young gc 的次数</td>
</tr>
<tr>
<td>YGCT</td>
<td>从应用程序启动到采样时 young gc 的所用的时间（s）</td>
</tr>
<tr>
<td>FGC</td>
<td>从应用程序启动到采样时 full gc 的次数</td>
</tr>
<tr>
<td>FGCT</td>
<td>从应用程序启动到采样时 full gc 的所用的时间</td>
</tr>
<tr>
<td>GCT</td>
<td>从应用程序启动到采样时整个 gc 所用的时间</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：年轻代的 Edem 区满了会触发 young gc，老年代满了会触发 old gc。full gc 指的是清除整个堆，包括 young 区 和 old 区。</p>
</blockquote>
<p>jstat 常用的查询参数有：</p>
<ul>
<li>-class，查询类加载器信息；</li>
<li>-compiler，JIT 相关信息；</li>
<li>-gc，GC 堆状态；</li>
<li>-gcnew，新生代统计信息；</li>
<li>-gcutil，GC 堆统计汇总信息。</li>
</ul>
<h4 id="3-jinfo（查询虚拟机参数配置工具）"><a href="#3-jinfo（查询虚拟机参数配置工具）" class="headerlink" title="3. jinfo（查询虚拟机参数配置工具）"></a>3. jinfo（查询虚拟机参数配置工具）</h4><p>jinfo（Configuration Info for Java）用于查看和调整虚拟机各项参数。语法如下：</p>
<p>复制</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jinfo &lt;option&gt; &lt;pid&gt;</span><br></pre></td></tr></table></figure>

<p>查看 JVM 参数示例如下：</p>
<p>复制</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  jinfo <span class="literal">-flags</span> <span class="number">45129</span></span><br><span class="line">VM Flags:</span><br><span class="line"><span class="literal">-XX</span>:CICompilerCount=<span class="number">3</span> <span class="literal">-XX</span>:InitialHeapSize=<span class="number">268435456</span> <span class="literal">-XX</span>:MaxHeapSize=<span class="number">4294967296</span> <span class="literal">-XX</span>:MaxNewSize=<span class="number">1431306240</span> <span class="literal">-XX</span>:MinHeapDeltaBytes=<span class="number">524288</span> <span class="literal">-XX</span>:NewSize=<span class="number">89128960</span> <span class="literal">-XX</span>:OldSize=<span class="number">179306496</span> <span class="literal">-XX</span>:+UseCompressedClassPointers <span class="literal">-XX</span>:+UseCompressedOops <span class="literal">-XX</span>:+UseFastUnorderedTimeStamps <span class="literal">-XX</span>:+UseParallelGC</span><br></pre></td></tr></table></figure>

<p>其中 45129 是使用 jps 查询的 LVMID。<br>我们可以通过 jinfo -flag [+/-]name 来修改虚拟机的参数值，比如下面的示例：</p>
<p>复制</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  jinfo <span class="literal">-flag</span> PrintGC <span class="number">45129</span> <span class="comment"># 查询是否开启 GC 打印</span></span><br><span class="line"><span class="literal">-XX</span>:<span class="literal">-PrintGC</span></span><br><span class="line">➜  jinfo <span class="literal">-flag</span> +PrintGC <span class="number">45129</span> <span class="comment"># 开启 GC 打印</span></span><br><span class="line">➜  jinfo <span class="literal">-flag</span> PrintGC <span class="number">45129</span> <span class="comment"># 查询是否开启 GC 打印</span></span><br><span class="line"><span class="literal">-XX</span>:+PrintGC</span><br><span class="line">➜  jinfo <span class="literal">-flag</span> <span class="literal">-PrintGC</span> <span class="number">45129</span> <span class="comment"># 关闭 GC 打印</span></span><br><span class="line">➜  jinfo <span class="literal">-flag</span> PrintGC <span class="number">45129</span> <span class="comment"># 查询是否开启 GC 打印</span></span><br><span class="line"><span class="literal">-XX</span>:<span class="literal">-PrintGC</span></span><br></pre></td></tr></table></figure>

<h4 id="4-jmap（堆快照生成工具）"><a href="#4-jmap（堆快照生成工具）" class="headerlink" title="4. jmap（堆快照生成工具）"></a>4. jmap（堆快照生成工具）</h4><p>jmap（Memory Map for Java）用于查询堆的快照信息。</p>
<p>查询堆信息示例如下：</p>
<p>复制</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">➜  jmap <span class="literal">-heap</span> <span class="number">45129</span></span><br><span class="line">Attaching to <span class="keyword">process</span> ID <span class="number">45129</span>, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is <span class="number">25.101</span><span class="literal">-b13</span></span><br><span class="line"><span class="keyword">using</span> thread-local object allocation.</span><br><span class="line">Parallel GC with <span class="number">6</span> thread(s)</span><br><span class="line">Heap Configuration:</span><br><span class="line">   MinHeapFreeRatio         = <span class="number">0</span></span><br><span class="line">   MaxHeapFreeRatio         = <span class="number">100</span></span><br><span class="line">   MaxHeapSize              = <span class="number">4294967296</span> (<span class="number">4096.0</span>MB)</span><br><span class="line">   NewSize                  = <span class="number">89128960</span> (<span class="number">85.0</span>MB)</span><br><span class="line">   MaxNewSize               = <span class="number">1431306240</span> (<span class="number">1365.0</span>MB)</span><br><span class="line">   OldSize                  = <span class="number">179306496</span> (<span class="number">171.0</span>MB)</span><br><span class="line">   NewRatio                 = <span class="number">2</span></span><br><span class="line">   SurvivorRatio            = <span class="number">8</span></span><br><span class="line">   MetaspaceSize            = <span class="number">21807104</span> (<span class="number">20.796875</span>MB)</span><br><span class="line">   CompressedClassSpaceSize = <span class="number">1073741824</span> (<span class="number">1024.0</span>MB)</span><br><span class="line">   MaxMetaspaceSize         = <span class="number">17592186044415</span> MB</span><br><span class="line">   G1HeapRegionSize         = <span class="number">0</span> (<span class="number">0.0</span>MB)</span><br><span class="line">Heap Usage:</span><br><span class="line">PS Young Generation</span><br><span class="line">Eden Space:</span><br><span class="line">   capacity = <span class="number">67108864</span> (<span class="number">64.0</span>MB)</span><br><span class="line">   used     = <span class="number">5369232</span> (<span class="number">5.1204986572265625</span>MB)</span><br><span class="line">   free     = <span class="number">61739632</span> (<span class="number">58.87950134277344</span>MB)</span><br><span class="line">   <span class="number">8.000779151916504</span>% used</span><br><span class="line">From Space:</span><br><span class="line">   capacity = <span class="number">11010048</span> (<span class="number">10.5</span>MB)</span><br><span class="line">   used     = <span class="number">0</span> (<span class="number">0.0</span>MB)</span><br><span class="line">   free     = <span class="number">11010048</span> (<span class="number">10.5</span>MB)</span><br><span class="line">   <span class="number">0.0</span>% used</span><br><span class="line">To Space:</span><br><span class="line">   capacity = <span class="number">11010048</span> (<span class="number">10.5</span>MB)</span><br><span class="line">   used     = <span class="number">0</span> (<span class="number">0.0</span>MB)</span><br><span class="line">   free     = <span class="number">11010048</span> (<span class="number">10.5</span>MB)</span><br><span class="line">   <span class="number">0.0</span>% used</span><br><span class="line">PS Old Generation</span><br><span class="line">   capacity = <span class="number">179306496</span> (<span class="number">171.0</span>MB)</span><br><span class="line">   used     = <span class="number">0</span> (<span class="number">0.0</span>MB)</span><br><span class="line">   free     = <span class="number">179306496</span> (<span class="number">171.0</span>MB)</span><br><span class="line">   <span class="number">0.0</span>% used</span><br><span class="line"></span><br><span class="line"><span class="number">2158</span> interned Strings occupying <span class="number">152472</span> bytes.</span><br></pre></td></tr></table></figure>

<p>我们也可以直接生成堆快照文件，示例如下：</p>
<p>复制</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜  jmap <span class="literal">-dump</span>:format=b,file=/Users/admin/Documents/<span class="number">2020</span>.dump <span class="number">47380</span></span><br><span class="line">Dumping heap to /Users/admin/Documents/<span class="number">2020</span>.dump ...</span><br><span class="line">Heap dump file created</span><br></pre></td></tr></table></figure>

<h4 id="5-jhat（堆快照分析功能）"><a href="#5-jhat（堆快照分析功能）" class="headerlink" title="5. jhat（堆快照分析功能）"></a>5. jhat（堆快照分析功能）</h4><p>jhat（JVM Heap Analysis Tool，堆快照分析工具）和 jmap 搭配使用，用于启动一个 web 站点来分析 jmap 生成的快照文件。</p>
<p>执行示例如下：</p>
<p>复制</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">jhat /Users/admin/Documents/<span class="number">2020</span>.dump</span><br><span class="line">Reading from /Users/admin/Documents/<span class="number">2020</span>.dump...</span><br><span class="line">Dump file created Tue May <span class="number">26</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">41</span> CST <span class="number">2020</span></span><br><span class="line">Snapshot read, resolving...</span><br><span class="line">Resolving <span class="number">17797</span> objects...</span><br><span class="line">Chasing references, expect <span class="number">3</span> dots...</span><br><span class="line">Eliminating duplicate references...</span><br><span class="line">Snapshot resolved.</span><br><span class="line">Started HTTP server on port <span class="number">7000</span></span><br><span class="line">Server is ready.</span><br></pre></td></tr></table></figure>

<p>上述信息表示 jhat 启动了一个 http 的服务器端口为 7000 的站点来展示信息，此时我们在浏览器中输入：<a href="http://localhost:7000/，会看到如下图所示的信息：" target="_blank" rel="noopener">http://localhost:7000/，会看到如下图所示的信息：</a></p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/Ciqc1F7Z6YyAZxEUAAHRgiBjrK8704-20200830161816376.png" alt="Drawing 1.png"></p>
<h4 id="6-jstack（查询虚拟机当前的线程快照信息）"><a href="#6-jstack（查询虚拟机当前的线程快照信息）" class="headerlink" title="6. jstack（查询虚拟机当前的线程快照信息）"></a>6. jstack（查询虚拟机当前的线程快照信息）</h4><p>jstack（Stack Trace for Java）用于查看当前虚拟机的线程快照，用它可以排查线程的执行状况，例如排查死锁、死循环等问题。</p>
<p>比如，我们先写一段死锁的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeOptimize</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object obj1 = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object obj2 = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (obj2) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"锁住 obj2"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">synchronized</span> (obj1) &#123;</span><br><span class="line">                        <span class="comment">// 执行不到这里</span></span><br><span class="line">                        System.out.println(<span class="string">"1秒钟后，"</span> + Thread.currentThread().getName()</span><br><span class="line">                                + <span class="string">"锁住 obj1"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        <span class="keyword">synchronized</span> (obj1) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">"锁住 obj1"</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">synchronized</span> (obj2) &#123;</span><br><span class="line">                <span class="comment">// 执行不到这里</span></span><br><span class="line">                System.out.println(<span class="string">"1秒钟后，"</span> + Thread.currentThread().getName()</span><br><span class="line">                        + <span class="string">"锁住 obj2"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上程序的执行结果如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main：锁住 obj1</span><br><span class="line">Thread-<span class="number">0</span>：锁住 obj2</span><br></pre></td></tr></table></figure>

<p>此时我们使用 jstack 工具打印一下当前线程的快照信息，结果如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">➜  bin jstack <span class="literal">-l</span> <span class="number">50016</span></span><br><span class="line"><span class="number">2020</span><span class="literal">-05</span><span class="literal">-26</span> <span class="number">18</span>:<span class="number">01</span>:<span class="number">41</span></span><br><span class="line">Full thread dump Java HotSpot(TM) <span class="number">64</span><span class="literal">-Bit</span> Server VM (<span class="number">25.101</span><span class="literal">-b13</span> mixed mode):</span><br><span class="line"><span class="string">"Attach Listener"</span> <span class="comment">#10 daemon prio=9 os_prio=31 tid=0x00007f8c00840800 nid=0x3c03 waiting on condition [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"Thread-0"</span> <span class="comment">#9 prio=5 os_prio=31 tid=0x00007f8c00840000 nid=0x3e03 waiting for monitor entry [0x00007000100c8000]</span></span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at com.example.optimize.NativeOptimize<span class="variable">$1</span>.run(NativeOptimize.java:<span class="number">25</span>)</span><br><span class="line">	- waiting to lock &lt;<span class="number">0</span>x000000076abb62d0&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076abb62e0&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"Service Thread"</span> <span class="comment">#8 daemon prio=9 os_prio=31 tid=0x00007f8c01814800 nid=0x4103 runnable [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"C1 CompilerThread2"</span> <span class="comment">#7 daemon prio=9 os_prio=31 tid=0x00007f8c0283c800 nid=0x4303 waiting on condition [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"C2 CompilerThread1"</span> <span class="comment">#6 daemon prio=9 os_prio=31 tid=0x00007f8c0300a800 nid=0x4403 waiting on condition [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"C2 CompilerThread0"</span> <span class="comment">#5 daemon prio=9 os_prio=31 tid=0x00007f8c0283c000 nid=0x3603 waiting on condition [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"Signal Dispatcher"</span> <span class="comment">#4 daemon prio=9 os_prio=31 tid=0x00007f8c0283b000 nid=0x4603 runnable [0x0000000000000000]</span></span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"Finalizer"</span> <span class="comment">#3 daemon prio=8 os_prio=31 tid=0x00007f8c03001000 nid=0x5003 in Object.wait() [0x000070000f8ad000]</span></span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">	at java.lang.Object.wait(Native Method)</span><br><span class="line">	- waiting on &lt;<span class="number">0</span>x000000076ab08ee0&gt; (a java.lang.ref.ReferenceQueue<span class="variable">$Lock</span>)</span><br><span class="line">	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:<span class="number">143</span>)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076ab08ee0&gt; (a java.lang.ref.ReferenceQueue<span class="variable">$Lock</span>)</span><br><span class="line">	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:<span class="number">164</span>)</span><br><span class="line">	at java.lang.ref.Finalizer<span class="variable">$FinalizerThread</span>.run(Finalizer.java:<span class="number">209</span>)</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"Reference Handler"</span> <span class="comment">#2 daemon prio=10 os_prio=31 tid=0x00007f8c03000000 nid=0x2f03 in Object.wait() [0x000070000f7aa000]</span></span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">	at java.lang.Object.wait(Native Method)</span><br><span class="line">	- waiting on &lt;<span class="number">0</span>x000000076ab06b50&gt; (a java.lang.ref.Reference<span class="variable">$Lock</span>)</span><br><span class="line">	at java.lang.Object.wait(Object.java:<span class="number">502</span>)</span><br><span class="line">	at java.lang.ref.Reference.tryHandlePending(Reference.java:<span class="number">191</span>)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076ab06b50&gt; (a java.lang.ref.Reference<span class="variable">$Lock</span>)</span><br><span class="line">	at java.lang.ref.Reference<span class="variable">$ReferenceHandler</span>.run(Reference.java:<span class="number">153</span>)</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"main"</span> <span class="comment">#1 prio=5 os_prio=31 tid=0x00007f8c00802800 nid=0x1003 waiting for monitor entry [0x000070000ef92000]</span></span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at com.example.optimize.NativeOptimize.main(NativeOptimize.java:<span class="number">41</span>)</span><br><span class="line">	- waiting to lock &lt;<span class="number">0</span>x000000076abb62e0&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076abb62d0&gt; (a java.lang.Object)</span><br><span class="line">   Locked ownable synchronizers:</span><br><span class="line">	- None</span><br><span class="line"><span class="string">"VM Thread"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c01008800 nid=<span class="number">0</span>x2e03 runnable</span><br><span class="line"><span class="string">"GC task thread#0 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c00803000 nid=<span class="number">0</span>x2007 runnable</span><br><span class="line"></span><br><span class="line"><span class="string">"GC task thread#1 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c00006800 nid=<span class="number">0</span>x2403 runnable</span><br><span class="line"></span><br><span class="line"><span class="string">"GC task thread#2 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c01800800 nid=<span class="number">0</span>x2303 runnable</span><br><span class="line"><span class="string">"GC task thread#3 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c01801800 nid=<span class="number">0</span>x2a03 runnable</span><br><span class="line"><span class="string">"GC task thread#4 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c01802000 nid=<span class="number">0</span>x5403 runnable</span><br><span class="line"><span class="string">"GC task thread#5 (ParallelGC)"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c01006800 nid=<span class="number">0</span>x2d03 runnable</span><br><span class="line"><span class="string">"VM Periodic Task Thread"</span> os_prio=<span class="number">31</span> tid=<span class="number">0</span>x00007f8c00010800 nid=<span class="number">0</span>x3803 waiting on condition</span><br><span class="line">JNI global references: <span class="number">6</span></span><br><span class="line">Found one Java<span class="literal">-level</span> deadlock:</span><br><span class="line">=============================</span><br><span class="line"><span class="string">"Thread-0"</span>:</span><br><span class="line">  waiting to lock monitor <span class="number">0</span>x00007f8c000102a8 (object <span class="number">0</span>x000000076abb62d0, a java.lang.Object),</span><br><span class="line">  which is held by <span class="string">"main"</span></span><br><span class="line"><span class="string">"main"</span>:</span><br><span class="line">  waiting to lock monitor <span class="number">0</span>x00007f8c0000ed58 (object <span class="number">0</span>x000000076abb62e0, a java.lang.Object),</span><br><span class="line">  which is held by <span class="string">"Thread-0"</span></span><br><span class="line"></span><br><span class="line">Java stack information <span class="keyword">for</span> the threads listed above:</span><br><span class="line">===================================================</span><br><span class="line"><span class="string">"Thread-0"</span>:</span><br><span class="line">	at com.example.optimize.NativeOptimize<span class="variable">$1</span>.run(NativeOptimize.java:<span class="number">25</span>)</span><br><span class="line">	- waiting to lock &lt;<span class="number">0</span>x000000076abb62d0&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076abb62e0&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</span><br><span class="line"><span class="string">"main"</span>:</span><br><span class="line">	at com.example.optimize.NativeOptimize.main(NativeOptimize.java:<span class="number">41</span>)</span><br><span class="line">	- waiting to lock &lt;<span class="number">0</span>x000000076abb62e0&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;<span class="number">0</span>x000000076abb62d0&gt; (a java.lang.Object)</span><br><span class="line"></span><br><span class="line">Found <span class="number">1</span> deadlock.</span><br></pre></td></tr></table></figure>

<p>从上述信息可以看出使用 jstack ，可以很方便地排查出代码中出现“deadlock”（死锁）的问题。</p>
<h3 id="考点分析"><a href="#考点分析" class="headerlink" title="考点分析"></a>考点分析</h3><p>Java 虚拟机的排查工具是一个合格程序员必备的技能，使用它我们可以很方便地定位出问题的所在，尤其在团队合作的今天，每个人各守一摊很容易出现隐藏的 bug（缺陷）。因此使用这些排查功能可以帮我们快速地定位并解决问题，所以它也是面试中常问的问题之一。</p>
<p>和此知识点相关的面试题还有以下这些：</p>
<ul>
<li>除了比较实用的命令行工具之外，有没有方便一点的排查工具？</li>
<li>JVM 常见的调优手段有哪些？</li>
</ul>
<h3 id="知识扩展"><a href="#知识扩展" class="headerlink" title="知识扩展"></a>知识扩展</h3><h4 id="可视化排查工具"><a href="#可视化排查工具" class="headerlink" title="可视化排查工具"></a>可视化排查工具</h4><p>JVM 除了上面的 6 个基础命令行工具之外，还有两个重要的视图调试工具，即 JConsole 和 JVisualVM，它们相比于命令行工具使用更方便、操作更简单、结果展现也更直观。</p>
<p>JConsole 和 JVisualVM 都位于 JDK 的 bin 目录下，JConsole（Java Monitoring and Management Console）是最早期的视图调试工具，其启动页面如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/Ciqc1F7Z6ZuAZOoBAAIE-PlP8mY751-20200830161832760.png" alt="Drawing 2.png"></p>
<p>可以看出我们可以用它来连接远程的服务器，或者是直接调试本机，这样就可以在不消耗生产环境的性能下，从本机启动 JConsole 来连接服务器。选择了调试的进程之后，运行界面如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/CgqCHl7Z6aKAZfp0AAKE9E3ar6c820-20200830161844917.png" alt="Drawing 3.png"></p>
<p>从上图可以看出，使用 JConsole 可以监控线程、CPU、类、堆以及 VM 的相关信息，同样我们可以通过线程这一页的信息，发现之前我们故意写的死锁问题，如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/CgqCHl7Z6amAF-LOAAKoeNJzszw795-20200830161854018.png" alt="Drawing 4.png"></p>
<p>可以看到 main（主线程）和 Thread-0 线程处于死锁状态。</p>
<p>JVisualVM 的启动图如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/CgqCHl7Z6a-AK0DMAAHTxm7JgYI402-20200830161903350.png" alt="Drawing 5.png"></p>
<p>由上图可知，JVisualVM 既可以调试本地也可以调试远程服务器，当我们选择了相关的进程之后，运行如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/CgqCHl7Z6beAUJ6sAAMkaaTyA9U352-20200830161914346.png" alt="img"></p>
<p>可以看出 JVisualVM 除了包含了 JConsole 的信息之外，还有更多的详细信息，并且更加智能。例如，线程死锁检查的这页内容如下图所示：</p>
<p><img src= "/img/loading.gif" data-src="http://cdn.andiycc.com/blog_img/Ciqc1F7Z6b2Aa8CCAANpsufYncw124-20200830161927533.png" alt="Drawing 7.png"></p>
<p>可以看出 JVisualVM 会直接给你一个死锁的提示，而 JConsole 则需要程序员自己分析。</p>
<h4 id="JVM-调优"><a href="#JVM-调优" class="headerlink" title="JVM 调优"></a>JVM 调优</h4><p>JVM 调优主要是根据实际的硬件配置信息重新设置 JVM 参数来进行调优的，例如，硬件的内存配置很高，但 JVM 因为是默认参数，所以最大内存和初始化堆内存很小，这样就不能更好地利用本地的硬件优势了。因此，需要调整这些参数，让 JVM 在固定的配置下发挥最大的价值。</p>
<p>JVM 常见调优参数包含以下这些：</p>
<ul>
<li>-Xmx，设置最大堆内存大小；</li>
<li>-Xms，设置初始堆内存大小；</li>
<li>-XX:MaxNewSize，设置新生代的最大内存；</li>
<li>-XX:MaxTenuringThreshold，设置新生代对象经过一定的次数晋升到老生代；</li>
<li>-XX:PretrnureSizeThreshold，设置大对象的值，超过这个值的对象会直接进入老生代；</li>
<li>-XX:NewRatio，设置分代垃圾回收器新生代和老生代内存占比；</li>
<li>-XX:SurvivorRatio，设置新生代 Eden、Form Survivor、To Survivor 占比。</li>
</ul>
<p>我们要根据自己的业务场景和硬件配置来设置这些值。例如，当我们的业务场景会有很多大的临时对象产生时，因为这些大对象只有很短的生命周期，因此需要把“-XX:MaxNewSize”的值设置的尽量大一些，否则就会造成大量短生命周期的大对象进入老生代，从而很快消耗掉了老生代的内存，这样就会频繁地触发 full gc，从而影响了业务的正常运行。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>本课时我们讲了 JVM 排查的 6 个基本命令行工具：jps、jstat、jinfo、jmap、jhat、jstack，以及 2 个视图排查工具：JConsole 和 JVisualVM；同时还讲了 JVM 的常见调优参数，希望本课时的内容可以切实的帮助到你。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">GuoTao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://tomones.github.io/2020/08/27/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E6%8E%92%E9%99%A4%E5%92%8C%E4%BC%98%E5%8C%96%20JVM%EF%BC%9F/">https://tomones.github.io/2020/08/27/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E6%8E%92%E9%99%A4%E5%92%8C%E4%BC%98%E5%8C%96%20JVM%EF%BC%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://tomones.github.io" target="_blank">凌虚阁</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=null" async="async"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="http://cdn.andiycc.com/wechat.png" alt="微信" onclick="window.open('http://cdn.andiycc.com/wechat.png')"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="http://cdn.andiycc.com/alipay.png" alt="支付宝" onclick="window.open('http://cdn.andiycc.com/alipay.png')"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/27/%E6%B7%B1%E5%85%8B%E9%9A%86%E5%92%8C%E6%B5%85%E5%85%8B%E9%9A%86%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F%E5%AE%83%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B?%20/"><img class="prev-cover" data-src="http://cdn.andiycc.com/fengmian.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">深克隆和浅克隆有什么区别？它的实现方式有哪些？</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/27/%E7%BA%A2%E9%BB%91%E6%A0%91%E5%92%8C%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F/"><img class="next-cover" data-src="http://cdn.andiycc.com/fengmian.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">红黑树和平衡二叉树有什么区别？</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/27/Docker 有什么优点？使用时需要注意什么问题？/" title="Docker 有什么优点？使用时需要注意什么问题？"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-27</div><div class="relatedPosts_title">Docker 有什么优点？使用时需要注意什么问题？</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/27/HashMap 底层实现原理是什么？JDK8 做了哪些优化？/" title="HashMap 底层实现原理是什么？JDK8 做了哪些优化？"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-27</div><div class="relatedPosts_title">HashMap 底层实现原理是什么？JDK8 做了哪些优化？</div></div></a></div><div class="relatedPosts_item"><a href="/2020/05/30/Java-lang-NoClassdefFoundError-Could-Not-Initialize-Class-Sun-AWT-X11-XtoolKit异常解决/" title="Java.lang.NoClassdefFoundError: Could Not Initialize Class Sun.AWT.X11.XtoolKit异常解决"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-30</div><div class="relatedPosts_title">Java.lang.NoClassdefFoundError: Could Not Initialize Class Sun.AWT.X11.XtoolKit异常解决</div></div></a></div><div class="relatedPosts_item"><a href="/2020/05/30/Java8新特性总结/" title="Java8新特性总结"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-30</div><div class="relatedPosts_title">Java8新特性总结</div></div></a></div><div class="relatedPosts_item"><a href="/2020/05/30/Java中15种锁的介绍：公平锁，可重入锁，独享锁，互斥锁，乐观锁，分段锁，自旋锁等等/" title="Java中15种锁的介绍：公平锁，可重入锁，独享锁，互斥锁，乐观锁，分段锁，自旋锁等等"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-30</div><div class="relatedPosts_title">Java中15种锁的介绍：公平锁，可重入锁，独享锁，互斥锁，乐观锁，分段锁，自旋锁等等</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/30/MQ 有什么作用？你都用过哪些 MQ 中间件？/" title="MQ 有什么作用？你都用过哪些 MQ 中间件？"><img class="relatedPosts_cover" data-src="http://cdn.andiycc.com/fengmian.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-30</div><div class="relatedPosts_title">MQ 有什么作用？你都用过哪些 MQ 中间件？</div></div></a></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By GuoTao</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">簡</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="true" src="/js/third-party/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/click_heart.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>